#!/usr/bin/env python3
import os,argparse
path_self = os.path.realpath(__file__)
path_gui = os.path.abspath(os.path.join(path_self,'..','..','gui'))
path_code = os.path.abspath(os.path.join(path_self,'..','..'))
path_web = os.path.abspath(os.path.join(path_self,'..','..','gui','src-flask-server'))

## parser
parser = argparse.ArgumentParser(
    prog = 'mastotron',
    description = 'GUI and programmatic interface to mastodon',
)
parser.add_argument('--web', action='store_true')
parser.add_argument('--code', action='store_true')



def main():
    args = parser.parse_args()
    args_d = vars(args)

    if args_d.get('web'):
        os.system(f'cd {path_web} && python app.py')
    elif args_d.get('code'):
        imp='from mastotron import *'
        cmd = ' && '.join([
            f'cd {path_code}',
            f'''ipython -c "{imp}; print('>>> {imp}')" -i'''
        ])
        os.system(cmd)
    else:
        os.system(f'cd {path_gui} && npm start')


### RUN
if __name__ == '__main__': main()
